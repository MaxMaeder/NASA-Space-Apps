"use client";

import { useEffect, useRef, useState } from 'react';

import { motion } from 'framer-motion';

// import { loadData } from '../tone/sonification';

const delayBetweenBars = 150; // Milliseconds

function shuffle(array) {
    let currentIndex = array.length,  randomIndex;
  
    // While there remain elements to shuffle.
    while (currentIndex > 0) {
  
      // Pick a remaining element.
      randomIndex = Math.floor(Math.random() * currentIndex);
      currentIndex--;
  
      // And swap it with the current element.
      [array[currentIndex], array[randomIndex]] = [
        array[randomIndex], array[currentIndex]];
    }
  
    return array;
  }

// Create a queue of buffers
let bufQueue: any = [[25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250]
                    ];

                    bufQueue = shuffle(bufQueue.map(e => shuffle(e)));

let bufQueueTemplate: any = [[25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],
                    [25, 50, 75, 100, 125, 150, 175, 200, 225, 250],
                    [50, 100, 150, 200, 250, 300, 350, 400, 450, 500],
                    [75, 150, 225, 300, 375, 450, 525, 600, 675, 750],
                    [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
                    [125, 250, 375, 500, 625, 750, 875, 1000, 1125, 1250],];

export function createBuffer(newBuf: any[]) {
    // Add buffer to queue
    bufQueue.push(newBuf);
}

export function setBuffer(newBuf: any[]) {
    // Set buffer to queue
    bufQueue = newBuf;
}

export default function Waveform() {
    let [height, setHeight] = useState<number>(640); // Height of container
    let [barHeights, setBarHeights] = useState<number[]>([]); // Array of bar heights [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

    // Load buffer before rendering
    // useEffect(() => {
    //     loadData();
    // }, []);

    useEffect(() => {
        // Set the barHeights state to change to the next buffer in the queue every delayBetweenBars milliseconds
        // If the queue is empty, create a new buffer as a placeholder or filler buffer
        let interval = setInterval(() => {
            if (bufQueue.length > 0) {
                setBarHeights(bufQueue.shift());
            } else {
                // bufQueue = bufQueueTemplate;
                createBuffer([0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
            }
        }, delayBetweenBars);

        return () => clearInterval(interval);
    }, [barHeights]);

    let constructBars = (): any[] => {
        let barArray: any[] = []; // Return array of bars
    
        let newBar = (freq: number): any => {
            return <motion.div className={"bg-gray-500 rounded-lg w-full opacity-50"} style={{"height": 0}}
                animate={{ height: freq > height ? height : freq }}
                transition={{ duration: 0.25 }}
            ></motion.div>;
        }
    
        if (barHeights.length > 0) {
            for (let i = 0; i < barHeights.length; i++) {
                barArray.push(newBar(barHeights[i]));
            }
        }
    
        return barArray;
    }

    return (
        <div className={"w-full flex flex-row space-x-2"} style={{"height": height}}>
            { constructBars() }
        </div>
    );
}
